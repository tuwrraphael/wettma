!function(){"use strict";var e,t,n,i,r={258:function(e,t,n){function i(e,t,n,i){e.addEventListener(t,n),i.addEventListener("abort",(()=>{e.removeEventListener(t,n)}))}n.d(t,{I:function(){return i}})},471:function(e,t,n){n.d(t,{W:function(){return p}});class i{constructor(e,t){this.routeResolver=e,this.routeRenderer=t,this.lastRoute=null,this.popStateListener=this.handlePopState.bind(this)}handlePopState(e){this.resolve(window.location.pathname,{searchParams:new URLSearchParams(window.location.search)}).then((e=>this.render(e)))}run(){let e=document.querySelector("base");this.basePrefix=e.getAttribute("href"),this.baseHref=e.href,window.addEventListener("popstate",this.popStateListener),this.resolve(window.location.pathname,{searchParams:new URLSearchParams(window.location.search)}).then((e=>this.render(e)))}destroy(){window.removeEventListener("popstate",this.popStateListener)}resolve(e,t){let n=this.getRoute(e);return Promise.resolve(this.routeResolver.resolve(this.lastRoute,n,this,t)).then((e=>!!e&&{resolved:e,currentRoute:n}))}render(e){return!!e&&(this.routeRenderer.render(e.resolved),this.lastRoute=e.currentRoute,!0)}getRoute(e){let t=e===this.baseHref,n=e.substr(0,this.basePrefix.length)===this.basePrefix;return t?"":n?e.substring(this.basePrefix.length):e}navigate(e,t,n){let i=new URL(e,this.baseHref);this.resolve(i.pathname,i).then((e=>{e&&(n?window.history.replaceState({},t||document.title,i.href):window.history.pushState({},t||document.title,i.href)),this.render(e)}))}}class r{constructor(e){this.container=e,this.currentComponent=!1}render(e){e&&(this.currentComponent&&(this.container.innerHTML=""),this.container.appendChild(e),this.currentComponent=!0)}}class s extends HTMLElement{constructor(){super(),this.innerHTML='<div class="container"> <section class="section"> <div>EM 2024 wird vorbereitet</div> </section> </div>'}connectedCallback(){}updateState(e){null!=e&&(this.upcomingGamesRenderer.update(e.upcomingGames,((e,t)=>{e.children[0].setGame(t)})),this.finishedGamesRenderer.update(e.finishedGames,((e,t)=>{e.children[0].setGame(t)})),this.showMore.style.display=e.hasMoreFinishedGames?"":"none")}disconnectedCallback(){}}customElements.define("home-component",s);class o extends HTMLElement{constructor(){super(),this.innerHTML='<form method="GET" action="https://accounts.google.com/o/oauth2/v2/auth" id="login_form"> <input type="hidden" name="client_id" id="client_id" value="439677686972-2c42enpqguk403j6nsb225e509n60ul9.apps.googleusercontent.com"> <input type="hidden" name="redirect_uri" id="redirect_uri"> <input type="hidden" name="response_type" value="token id_token"> <input type="hidden" name="login_hint" id="login_hint"> <input type="hidden" name="nonce" id="nonce"> <input type="hidden" name="scope" value="openid"> <button type="submit">Login über Google</button> </form>'}connectedCallback(){this.nonceInput=this.querySelector("#nonce"),this.redirectUriInput=this.querySelector("#redirect_uri"),this.redirectUriInput.value=window.location.href.replace(/\/(login|explanation|scoreboard|setresult)|(\?.+)|(\#.+)/g,"").replace(/(\/$)/g,""),this.loginHintInput=this.querySelector("#login_hint"),this.loginForm=this.querySelector("#login_form"),this.nonceInput.value=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<8;i++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}()}disconnectedCallback(){}setLoginHint(e){this.loginHintInput.value=e}submit(){this.loginForm.submit()}}customElements.define("login-form",o);class a extends HTMLElement{constructor(){super(),this.innerHTML='<div class="container"> <section class="section"> <h2> Login </h2> <p>Du musst dich zuerst anmelden bevor du fortfahren kannst.</p> <login-form></login-form> </section> </div>',this.loginForm=this.querySelector("login-form")}connectedCallback(){"FederatedCredential"in window&&navigator.credentials.get({federated:{providers:["https://google.wettma.kesal.at"]},mediation:"optional"}).then((e=>{e&&"federated"==e.type&&(this.loginForm.setLoginHint(e.id),this.loginForm.submit())}))}disconnectedCallback(){}}customElements.define("login-component",a);var l=n(258);class c{constructor(e){this.displayName=e,this.type=3}}var u=n(36),d=n(234);class h extends HTMLElement{constructor(){super(),this.innerHTML='<div class="container"> <section class="section"> <h2> Anzeigenamen </h2> <p>Lege einen Anzeigenamen fest. Dieser wird <strong>für alle ersichtlich</strong> in der Rangliste angezeigt.</p> <form> <label for="display-name">Anzeigename</label> <input type="text" id="display-name" name="display-name" maxlength="15" required="required"> <button type="submit">Speichern</button> </form> <span style="display:none" id="register-failed">Registrierung fehlgeschlagen</span> </section> </div>',this.form=this.querySelector("form"),this.registerFailed=this.querySelector("#register-failed"),this.store=d.y.getInstance(),this.router=p.getInstance()}connectedCallback(){this.abortController=new AbortController,(0,l.I)(this.form,"submit",(e=>this.onFormSubmit(e)),this.abortController.signal),this.store.subscribe((e=>this.updateState(e)),this.abortController.signal),this.updateState(this.store.state)}updateState(e){null!=e&&(e.register==u.y.Successful&&this.router.router.navigate("","wettma",!0),this.registerFailed.style.display=e.register==u.y.Failed?"inline":"none")}onFormSubmit(e){e.preventDefault();let t=new FormData(this.form).get("display-name");this.store.postAction(new c(t))}disconnectedCallback(){this.abortController.abort()}}customElements.define("register-component",h);class p{static getInstance(){return null==this.instance&&(this.instance=new p),this.instance}constructor(){let e=this;this.router=new i(new class{async resolve(t,i,r){switch(i){case"login":return e.activeRoute="login",new a;case"register":return e.activeRoute="register",new h;case"explanation":e.activeRoute="explanation";let{ExplanationComponent:t}=await n.e(554).then(n.bind(n,554));return new t;case"scoreboard":e.activeRoute="scoreboard";let{ScoreboardComponent:i}=await n.e(698).then(n.bind(n,698));return new i;case"setresult":e.activeRoute="setresult";let{SetResultComponent:r}=await n.e(151).then(n.bind(n,151));return new r;default:return e.activeRoute="home",new s}}},new r(document.getElementById("content")))}}p.instance=null},36:function(e,t,n){var i;n.d(t,{y:function(){return i}}),function(e){e[e.Unset=0]="Unset",e[e.InProgress=1]="InProgress",e[e.Successful=2]="Successful",e[e.Failed=3]="Failed"}(i||(i={}))},234:function(e,t,n){n.d(t,{y:function(){return i}});class i{get state(){return this._state}static getInstance(){return null==this.instance&&(this.instance=new i),this.instance}constructor(){this._state=null,this.subscriptions=[],this.worker=new Worker(new URL(n.p+n.u(772),n.b)),this.worker.addEventListener("message",(e=>{this._state=e.data;for(let e of this.subscriptions)try{e.call(this._state)}catch(e){console.error("Error while updating",e)}}))}subscribe(e,t){let n={call:e};this.subscriptions.push(n),t&&t.addEventListener("abort",(()=>{this.subscriptions.splice(this.subscriptions.indexOf(n),1)}))}postAction(e){this.worker.postMessage(e)}}i.instance=null}},s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return r[e](n,n.exports,o),n.exports}o.m=r,o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))},o.u=function(e){return{151:"7b27028cc8667c6821be",554:"4cdb38c15f84fb35f2b4",698:"6439b1e755ce18c0fdac",772:"adeb6bfe448e8e2ec7d9"}[e]+".bundle.js"},o.miniCssF=function(e){return e+"."+{151:"8c5b220bf6f482881a90",554:"8c5b220bf6f482881a90",698:"914aee05d18f9b23de70"}[e]+".css"},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="wettma:",o.l=function(n,i,r,s){if(e[n])e[n].push(i);else{var a,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+r){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",t+r),a.src=n),e[n]=[i];var h=function(t,i){a.onerror=a.onload=null,clearTimeout(p);var r=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((function(e){return e(i)})),t)return t(i)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="/",n=function(e){return new Promise((function(t,n){var i=o.miniCssF(e),r=o.p+i;if(function(e,t){for(var n=document.getElementsByTagName("link"),i=0;i<n.length;i++){var r=(o=n[i]).getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(r===e||r===t))return o}var s=document.getElementsByTagName("style");for(i=0;i<s.length;i++){var o;if((r=(o=s[i]).getAttribute("data-href"))===e||r===t)return o}}(i,r))return t();!function(e,t,n,i){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.onerror=r.onload=function(s){if(r.onerror=r.onload=null,"load"===s.type)n();else{var o=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=o,l.request=a,r.parentNode.removeChild(r),i(l)}},r.href=t,document.head.appendChild(r)}(e,r,t,n)}))},i={826:0},o.f.miniCss=function(e,t){i[e]?t.push(i[e]):0!==i[e]&&{151:1,554:1,698:1}[e]&&t.push(i[e]=n(e).then((function(){i[e]=0}),(function(t){throw delete i[e],t})))},function(){o.b=document.baseURI||self.location.href;var e={826:0};o.f.j=function(t,n){var i=o.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise((function(n,r){i=e[t]=[n,r]}));n.push(i[2]=r);var s=o.p+o.u(t),a=new Error;o.l(s,(function(n){if(o.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,i[1](a)}}),"chunk-"+t,t)}};var t=function(t,n){var i,r,s=n[0],a=n[1],l=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(i in a)o.o(a,i)&&(o.m[i]=a[i]);l&&l(o)}for(t&&t(n);c<s.length;c++)r=s[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunkwettma=self.webpackChunkwettma||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),function(){var e=o(471);class t{constructor(e,t){this.accessToken=e,this.isStandalone=t,this.type=2}}class n{constructor(){this.type=1}}var i=o(234),r=o(258);class s{constructor(){this.type=4}}class a extends HTMLElement{constructor(){super(),this.innerHTML='<div class="app-bar__container"> <nav class="app-bar"> <a href=""> <h1> <span class="material-icons"> sports_soccer </span> wettma</h1> </a> <div class="user-container" id="user-container"> <span id="logged-in-user"></span> <button id="logout" style="display:none">Logout</button> <button id="login" style="display:none">Login</button> </div> </nav> </div>',this.store=i.y.getInstance(),this.router=e.W.getInstance(),this.displayName=this.querySelector("#logged-in-user"),this.logoutBtn=this.querySelector("#logout"),this.loginBtn=this.querySelector("#login"),this.userContainer=this.querySelector("#user-container")}connectedCallback(){this.abortController=new AbortController,(0,r.I)(this.logoutBtn,"click",(e=>{this.store.postAction(new s),sessionStorage.clear()}),this.abortController.signal),(0,r.I)(this.loginBtn,"click",(e=>{this.router.router.navigate("login","wettma - Login")}),this.abortController.signal),this.store.subscribe((e=>this.updateState(e)),this.abortController.signal),this.updateState(this.store.state),(0,r.I)(this.querySelector("a"),"click",(e=>{e.preventDefault(),this.router.router.navigate("","wettma")}),this.abortController.signal)}updateState(e){null!=e&&(this.displayName.innerText=e.displayName||"",this.displayName.style.display=e.accessToken?"inline":"none",this.logoutBtn.style.display=e.accessToken?"inline":"none",this.loginBtn.style.display=e.accessToken?"none":"inline")}disconnectedCallback(){this.abortController.abort()}}customElements.define("app-bar",a),"serviceWorker"in navigator&&window.addEventListener("load",(async()=>{navigator.serviceWorker.register("./sw.js").then((e=>{})).catch((e=>{console.log("SW registration failed: ",e)}))})),async function(){let r=e.W.getInstance();r.router.run();let s=i.y.getInstance();s.subscribe((e=>{e.goToLogin&&"login"!=r.activeRoute?(s.postAction(new n),r.router.navigate("login","wettma - Login")):e.goToRegister&&"register"!=r.activeRoute&&(s.postAction(new n),r.router.navigate("register","wettma - Registrieren"))}));let o=await async function(){const e="wettma-webapp-token";let t=new URLSearchParams(window.location.hash.replace(/^#/,"")),n=t.get("id_token");if(n){history.replaceState(null,null," ");let r=await fetch(`https://oauth2.googleapis.com/tokeninfo?id_token=${n}`),s=await r.json();if(!r.ok)throw new Error(`access token validation resulted in ${r.status}`);let o={token:n,exp:+new Date+1e3*parseInt(t.get("expires_in")),scope:s.scope,sub:s.sub};if(sessionStorage.setItem(e,JSON.stringify(o)),"FederatedCredential"in window){var i=await navigator.credentials.create({federated:{id:s.sub,provider:"https://google.wettma.kesal.at/"}});await navigator.credentials.store(i)}return o}{let t=sessionStorage.getItem(e);if(null!=t){let e=JSON.parse(t);if(e.exp>+new Date)return e}}return null}();s.postAction(new t(o,!(!navigator||!navigator.standalone)||!("function"!=typeof window.matchMedia||!window.matchMedia("(display-mode: standalone)").matches)))}().catch((e=>console.error(e)))}()}();
//# sourceMappingURL=0339e5cdffb7d6e590a9.bundle.js.map